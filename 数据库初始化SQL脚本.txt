-- 数据库初始化SQL脚本 - 电视直播网站

-- 创建自定义频道表
CREATE TABLE IF NOT EXISTS custom_channels (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  url TEXT NOT NULL,
  description TEXT,
  category TEXT NOT NULL DEFAULT 'entertainment',
  is_custom INTEGER DEFAULT 1,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 创建收藏频道表
CREATE TABLE IF NOT EXISTS favorite_channels (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  channel_id TEXT NOT NULL UNIQUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 创建最近观看表
CREATE TABLE IF NOT EXISTS recently_watched (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  channel_id TEXT NOT NULL,
  watched_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 创建索引以提高查询性能
CREATE INDEX IF NOT EXISTS idx_recently_watched_watched_at ON recently_watched(watched_at);

-- 使用说明：
-- 1. 将以上SQL代码复制到Cloudflare D1数据库的查询编辑器中
-- 2. 执行SQL代码创建所需的表结构
-- 3. 执行后会自动创建所有必要的表和索引
-- 4. 此脚本与网站自动初始化功能使用相同的SQL语句